<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5">
    <title>H ä»£å¸ Â· ç»æµæ¨¡å‹å…¨æ™¯ç™½çš®ä¹¦</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(145deg, #f6f9fc 0%, #e9f2f9 100%);
            font-family: 'Inter', 'Segoe UI', Roboto, system-ui, sans-serif;
            padding: 2rem 1.5rem;
            color: #1a2b3e;
            line-height: 1.5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* æ ‡é¢˜åŒº */
        .hero {
            text-align: center;
            margin-bottom: 2.5rem;
        }

        .hero h1 {
            font-size: 3rem;
            font-weight: 700;
            background: linear-gradient(135deg, #0b2b5c, #1b4a8b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.02em;
            display: inline-block;
            padding: 0 1rem;
        }

        .hero .sub {
            font-size: 1.2rem;
            color: #2c3e6d;
            background: rgba(255,255,255,0.5);
            backdrop-filter: blur(4px);
            display: inline-block;
            padding: 0.5rem 2rem;
            border-radius: 40px;
            margin-top: 0.5rem;
            border: 1px solid rgba(27,74,139,0.15);
            box-shadow: 0 4px 10px rgba(0,20,40,0.05);
        }

        /* ç½‘æ ¼å¡ç‰‡ */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.8rem;
            margin-bottom: 2.5rem;
        }

        .card {
            background: rgba(255,255,255,0.75);
            backdrop-filter: blur(12px);
            border-radius: 32px;
            padding: 1.8rem 1.5rem;
            border: 1px solid rgba(255,255,255,0.6);
            box-shadow: 0 20px 35px -10px rgba(0,30,60,0.15), 0 0 0 1px rgba(27,74,139,0.1) inset;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 28px 40px -12px rgba(0,40,80,0.25);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            border-bottom: 2px solid rgba(27,74,139,0.2);
            padding-bottom: 1rem;
            margin-bottom: 1.2rem;
        }

        .card-header span {
            font-size: 2rem;
            background: #1b4a8b;
            color: white;
            width: 48px;
            height: 48px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 20px;
            box-shadow: 0 8px 14px -6px #1b4a8b80;
        }

        .card-header h2 {
            font-size: 1.6rem;
            font-weight: 600;
            color: #0a2647;
        }

        .stat-list {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            font-size: 1.05rem;
            border-bottom: 1px dashed rgba(0,0,0,0.1);
            padding-bottom: 0.4rem;
        }

        .stat-label {
            color: #2d4a72;
            font-weight: 500;
        }

        .stat-value {
            font-weight: 700;
            background: #ffffffc0;
            padding: 0.2rem 0.8rem;
            border-radius: 40px;
            color: #00337c;
            border: 1px solid #bbcbe0;
        }

        .highlight {
            background: linear-gradient(145deg, #eef5ff, #ffffff);
            border-left: 6px solid #1b4a8b;
            padding: 1rem 1.4rem;
            border-radius: 24px;
            font-weight: 500;
            margin: 1.2rem 0 0;
            box-shadow: 0 6px 14px rgba(0,30,60,0.08);
        }

        .formula {
            font-family: 'JetBrains Mono', monospace;
            background: #0e1f33;
            color: #c7e0ff;
            padding: 0.5rem 1rem;
            border-radius: 40px;
            font-size: 0.95rem;
        }

        /* è®¡ç®—å™¨åŒºåŸŸ */
        .calculator {
            background: white;
            border-radius: 42px;
            padding: 2.5rem 2rem;
            box-shadow: 0 30px 45px -20px #0a2647;
            border: 1px solid rgba(27,74,139,0.3);
            margin: 3rem 0 2rem;
        }

        .calc-title {
            font-size: 2.2rem;
            font-weight: 700;
            color: #1b4a8b;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .calc-title::before {
            content: "âš¡";
            font-size: 2.2rem;
        }

        .param-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem 2rem;
            margin-bottom: 2rem;
        }

        .param-item {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }

        .param-item label {
            font-weight: 600;
            color: #1e3b63;
            font-size: 0.95rem;
            letter-spacing: 0.3px;
        }

        .param-item input {
            padding: 0.8rem 1rem;
            border: 2px solid #cdddec;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 500;
            background: #f3f8ff;
            transition: 0.15s;
            outline: none;
        }

        .param-item input:focus {
            border-color: #1b4a8b;
            box-shadow: 0 0 0 4px #a3c3e9;
        }

        .button-group {
            display: flex;
            gap: 1.2rem;
            flex-wrap: wrap;
            align-items: center;
            margin-top: 0.5rem;
        }

        .btn {
            background: #1b4a8b;
            border: none;
            color: white;
            font-weight: 600;
            font-size: 1.2rem;
            padding: 1rem 2.8rem;
            border-radius: 50px;
            cursor: pointer;
            transition: 0.15s;
            box-shadow: 0 10px 20px -5px #1b4a8b;
            border: 1px solid #ffffff50;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            background: #0f3a6b;
            transform: scale(1.02);
            box-shadow: 0 18px 25px -8px #0f3a6b;
        }

        .btn-outline {
            background: transparent;
            color: #1b4a8b;
            box-shadow: 0 0 0 2px #1b4a8b inset;
            border: none;
        }

        .btn-outline:hover {
            background: #e2edff;
            box-shadow: 0 0 0 2px #1b4a8b inset;
            transform: scale(1.02);
        }

        /* è¡¨æ ¼ */
        .table-wrapper {
            overflow-x: auto;
            margin-top: 2.5rem;
            border-radius: 30px;
            background: #ffffffd0;
            backdrop-filter: blur(4px);
            padding: 0.5rem;
            border: 1px solid #cdddec;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
            min-width: 700px;
        }

        th {
            background: #1b4a8b;
            color: white;
            padding: 1rem 0.8rem;
            font-weight: 600;
            font-size: 1rem;
            white-space: nowrap;
        }

        td {
            padding: 0.8rem 0.8rem;
            text-align: center;
            border-bottom: 1px solid #cfdeef;
            font-weight: 500;
        }

        tr:last-child td {
            border-bottom: none;
        }

        td:first-child, th:first-child {
            border-radius: 20px 0 0 20px;
        }
        td:last-child, th:last-child {
            border-radius: 0 20px 20px 0;
        }

        .note {
            background: #e9f2fa;
            border-radius: 24px;
            padding: 1.5rem;
            margin-top: 2rem;
            border-left: 10px solid #1b4a8b;
        }

        .footnote {
            color: #2b496e;
            font-size: 0.95rem;
            text-align: center;
            margin-top: 2rem;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="hero">
            <h1>H ç»æµæ¨¡å‹ Â· é€šè¯è“å›¾</h1>
            <div class="sub">âš¡ ç¤¾åŒºé©±åŠ¨ | é€šç¼©å›è´­ | è´¨æŠ¼é£è½® âš¡</div>
        </div>

        <!-- æ ¸å¿ƒæ•°æ®å¡ç‰‡ -->
        <div class="grid">
            <div class="card">
                <div class="card-header">
                    <span>ğŸ“Š</span>
                    <h2>æ€»ä¾›åº” & åˆå§‹æ± </h2>
                </div>
                <div class="stat-list">
                    <div class="stat-item"><span class="stat-label">æ€»å‘è¡Œé‡</span><span class="stat-value">10,000,000,000 H</span></div>
                    <div class="stat-item"><span class="stat-label">åˆå§‹æµåŠ¨æ€§</span><span class="stat-value">10,000 USDT + 2äº¿ H</span></div>
                    <div class="stat-item"><span class="stat-label">åˆå§‹ä»·æ ¼</span><span class="stat-value">$0.00005</span></div>
                    <div class="stat-item"><span class="stat-label">äº¤æ˜“ç¨è´¹</span><span class="stat-value">ä¹°å–å„ 5%</span></div>
                </div>
                <div class="highlight">ç¤¾åŒºå æ¯” 80% Â· 8äº¿ H ç”¨äºæ¿€åŠ±</div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span>ğŸ”’</span>
                    <h2>ç§å‹Ÿé˜¶æ®µ (ç¬¬ä¸€èŠ‚)</h2>
                </div>
                <div class="stat-list">
                    <div class="stat-item"><span class="stat-label">å‹Ÿé›†ç›®æ ‡</span><span class="stat-value">100,000 USDT</span></div>
                    <div class="stat-item"><span class="stat-label">æ—¥æ”¶ç›Šç‡</span><span class="stat-value">0.5%~1.2% (Hå¥–åŠ±)</span></div>
                    <div class="stat-item"><span class="stat-label">å‹Ÿé›†åä»·æ ¼</span><span class="stat-value">â‰ˆ $0.009</span></div>
                    <div class="stat-item"><span class="stat-label">ç¤¾åŒºæ¯”ä¾‹</span><span class="stat-value">98%</span></div>
                </div>
                <div class="highlight">3äº¿ H åˆ’æ‹¨è‡³è´¨æŠ¼æ±  Â· ç§å‹Ÿä¹°å…¥ 1.82äº¿ H (é¡¹ç›®æ–¹æŠ¤ç›˜)</div>
            </div>

            <div class="card">
                <div class="card-header">
                    <span>âš™ï¸</span>
                    <h2>è´¨æŠ¼ & é£è½®</h2>
                </div>
                <div class="stat-list">
                    <div class="stat-item"><span class="stat-label">è´¨æŠ¼H</span><span class="stat-value">å¾— H æ”¶ç›Š</span></div>
                    <div class="stat-item"><span class="stat-label">Boost ç©ºæŠ•</span><span class="stat-value">äº¤æ˜“é‡â‰¥500U äº«ç£¨æŸè¡¥è´´</span></div>
                    <div class="stat-item"><span class="stat-label">å›½åº“æ”¶å…¥</span><span class="stat-value">äº¤æ˜“é¢ 5.34%</span></div>
                </div>
                <div class="highlight">éè´¨æŠ¼æ‰€å¾—Häº¤æ˜“ï¼Œä¸äº«å—è¡¥è´´</div>
            </div>
        </div>

        <!-- å›½åº“ä¸è¿”ä½£ -->
        <div class="grid">
            <div class="card">
                <div class="card-header">
                    <span>ğŸ¦</span>
                    <h2>å›½åº“æœºåˆ¶ (ç¬¬ä¸‰èŠ‚)</h2>
                </div>
                <div class="stat-list">
                    <div class="stat-item"><span class="stat-label">äº¤æ˜“ç¨5%</span><span class="stat-value">å…¨éƒ¨å½’å›½åº“</span></div>
                    <div class="stat-item"><span class="stat-label">è¿”ä½£0.85%Ã—40%</span><span class="stat-value">=0.34%äº¤æ˜“é¢</span></div>
                    <div class="stat-item"><span class="stat-label">æ€»å›½åº“æµå…¥</span><span class="stat-value">5.34% äº¤æ˜“é¢</span></div>
                </div>
                <div class="highlight">ç”¨äºï¼šè¡¥è´´ã€åˆ†çº¢ã€å›è´­ã€æŠ¤ç›˜</div>
            </div>
            <div class="card">
                <div class="card-header">
                    <span>ğŸ“ˆ</span>
                    <h2>åŠ¨æ€å¹³è¡¡</h2>
                </div>
                <div class="stat-list">
                    <div class="stat-item"><span class="stat-label">å›è´­</span><span class="stat-value">â†‘U_LP, â†‘ä»·æ ¼</span></div>
                    <div class="stat-item"><span class="stat-label">å–å‡º(è´¨æŠ¼å¥–åŠ±)</span><span class="stat-value">â†“U_LP, â†“ä»·æ ¼</span></div>
                </div>
                <div class="formula" style="margin-top:0.8rem;">å‡€æ•ˆåº” = å›è´­é‡‘é¢ - å–å‡ºå¯¼è‡´çš„U_LPå‡å°‘</div>
            </div>
        </div>

        <!-- äº¤äº’å¼è®¡ç®—å™¨ -->
        <div class="calculator">
            <div class="calc-title">æ¨¡æ‹Ÿè®¡ç®—å™¨ Â· æ¨æ¼”ä»·æ ¼èµ°å‘</div>
            <div class="param-grid">
                <div class="param-item">
                    <label>ğŸ åˆå§‹U_LP (USDT)</label>
                    <input type="number" id="initU" value="10000" step="1000">
                </div>
                <div class="param-item">
                    <label>ğŸ”¹ åˆå§‹H_LP (H)</label>
                    <input type="number" id="initH" value="200000000" step="1000000">
                </div>
                <div class="param-item">
                    <label>ğŸ’° ç§å‹Ÿé‡‘é¢ (USDT)</label>
                    <input type="number" id="privateAmount" value="100000" step="5000">
                </div>
                <div class="param-item">
                    <label>ğŸ“Š æ¯æ—¥äº¤æ˜“é¢ V (USDT)</label>
                    <input type="number" id="dailyV" value="1000000" step="100000">
                </div>
                <div class="param-item">
                    <label>â›“ï¸ æ¯æ—¥è´¨æŠ¼é‡Šæ”¾ H_reward</label>
                    <input type="number" id="rewardH" value="100000" step="10000">
                </div>
                <div class="param-item">
                    <label>ğŸ“… ç§å‹Ÿæ—¥æ”¶ç›Šç‡ (å¦‚0.0085)</label>
                    <input type="number" id="privateYield" value="0.0085" step="0.001" min="0" max="0.02">
                </div>
                <div class="param-item">
                    <label>ğŸ§¾ ç§å‹Ÿè´¨æŠ¼æ€»é¢ (USDT)</label>
                    <input type="number" id="privateStaked" value="100000" step="1000">
                </div>
                <div class="param-item">
                    <label>ğŸ“¤ å–å‡ºæ¯”ä¾‹ (0-1)</label>
                    <input type="number" id="sellRatio" value="1" step="0.1" min="0" max="1">
                </div>
                <div class="param-item">
                    <label>ğŸ”„ å›è´­æ¯”ä¾‹ (0-1)</label>
                    <input type="number" id="buybackRatio" value="1" step="0.1" min="0" max="1">
                </div>
                <div class="param-item">
                    <label>ğŸ“† æ¨¡æ‹Ÿå¤©æ•°</label>
                    <input type="number" id="days" value="8" min="1" max="20">
                </div>
            </div>
            <div class="button-group">
                <button class="btn" id="calcBtn">ğŸš€ è¿è¡Œæ¨¡æ‹Ÿ</button>
                <button class="btn-outline btn" id="resetDefault">â†º é‡ç½®é»˜è®¤</button>
            </div>

            <!-- ç»“æœè¡¨æ ¼ -->
            <div class="table-wrapper" id="resultTable">
                <table>
                    <thead>
                        <tr><th>å¤©æ•°</th><th>ä»·æ ¼ (USDT)</th><th>U_LP</th><th>H_LP</th><th>å›½åº“ç´¯è®¡</th><th>ç§å‹Ÿé‡Šæ”¾(H)</th></tr>
                    </thead>
                    <tbody id="tableBody">
                        <tr><td colspan="6" style="text-align:center; padding:2rem;">ç‚¹å‡»ã€Œè¿è¡Œæ¨¡æ‹Ÿã€ç”Ÿæˆæ•°æ®</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="note">
                <strong>ğŸ“Œ æ¨¡æ‹Ÿé€»è¾‘è¯´æ˜</strong><br>
                â€¢ ç¬¬0å¤©ä¸ºç§å‹ŸåçŠ¶æ€ï¼šU_LP += ç§å‹Ÿé‡‘é¢ï¼ŒH_LP = k / æ–°U_LPï¼Œä»·æ ¼ = U_LPÂ²/k<br>
                â€¢ æ¯æ—¥å›½åº“æ”¶å…¥ R = äº¤æ˜“é¢ Ã— 5.34%<br>
                â€¢ å–å‡ºï¼šè´¨æŠ¼é‡Šæ”¾ + ç§å‹Ÿé‡Šæ”¾ (ç§å‹Ÿé‡Šæ”¾ = ç§å‹Ÿæ€»é¢Ã—æ—¥æ”¶ç›Šç‡ / å‰ä¸€æ—¥ä»·æ ¼)<br>
                â€¢ å–å‡ºä½¿U_temp = k / (H + 0.95Ã—å–å‡ºé‡) ; å›è´­ä½¿U_new = U_temp + 0.95Ã—RÃ—å›è´­æ¯”ä¾‹<br>
                â€¢ ä»·æ ¼ã€H_LPåŒæ­¥æ›´æ–°ã€‚é»˜è®¤å…¨éƒ¨å–å‡º/å›è´­ (æ¯”ä¾‹=1)ã€‚ 
            </div>
        </div>

        <!-- é¢å¤–åˆ†æ -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 2rem 0;">
            <div class="card" style="background: #ffffffd0;">
                <h3 style="font-size: 1.8rem; margin-bottom: 1rem;">ğŸ“‰ å¹³è¡¡æ¡ä»¶</h3>
                <p>å½“æ¯æ—¥å›è´­é‡‘é¢ <br> <code class="formula" style="display: inline-block;">R * å›è´­æ¯”ä¾‹</code> <br> ç­‰äºå–å‡ºå¯¼è‡´çš„U_LPå‡å°‘é‡æ—¶ï¼Œä»·æ ¼ç¨³å®šã€‚</p>
                <p style="margin-top:1rem;">è‹¥äº¤æ˜“é¢è¶³å¤Ÿå¤§ï¼Œå›è´­åŠ›é‡ > æŠ›å‹ï¼Œä»·æ ¼è¿›å…¥æ­£å‘èºæ—‹ã€‚</p>
            </div>
            <div class="card" style="background: #ffffffd0;">
                <h3 style="font-size: 1.8rem; margin-bottom: 1rem;">ğŸ’ ç¤¾åŒºæŠ¤ç›¾</h3>
                <p>â€¢ ä»…è´¨æŠ¼æ‰€å¾—Häº¤æ˜“äº«ç£¨æŸè¡¥è´´<br>â€¢ æ¬§æ˜“è¿”ä½£0.34%äº¤æ˜“é¢æ³¨å…¥å›½åº“<br>â€¢ é¡¹ç›®æ–¹æŒ1.82äº¿H(ç§å‹Ÿä¹°å…¥)ç”¨äºæŠ¤ç›˜</p>
            </div>
        </div>

        <div class="footnote">
            âš¡ H ç»æµæ¨¡å‹ Â· æ‰€æœ‰æ•°æ®æ¨¡æ‹Ÿä»…ä¾›å‚è€ƒ Â· å®é™…ä»¥å¸‚åœºä¸ºå‡† âš¡
        </div>
    </div>

    <script>
        (function() {
            // è·å–DOMå…ƒç´ 
            const initUInp = document.getElementById('initU');
            const initHInp = document.getElementById('initH');
            const privateAmtInp = document.getElementById('privateAmount');
            const dailyVInp = document.getElementById('dailyV');
            const rewardHInp = document.getElementById('rewardH');
            const yieldInp = document.getElementById('privateYield');
            const privateStakedInp = document.getElementById('privateStaked');
            const sellRatioInp = document.getElementById('sellRatio');
            const bbRatioInp = document.getElementById('buybackRatio');
            const daysInp = document.getElementById('days');
            const calcBtn = document.getElementById('calcBtn');
            const resetBtn = document.getElementById('resetDefault');
            const tbody = document.getElementById('tableBody');

            // ç¨è´¹å¸¸æ•°
            const TAX = 0.05;            // 5% äº¤æ˜“ç¨
            const NET_RATIO = 1 - TAX;    // 0.95
            const TREASURY_RATE = 0.0534; // 5% + 0.34%

            // é‡ç½®é»˜è®¤å€¼
            resetBtn.addEventListener('click', () => {
                initUInp.value = '10000';
                initHInp.value = '200000000';
                privateAmtInp.value = '100000';
                dailyVInp.value = '1000000';
                rewardHInp.value = '100000';
                yieldInp.value = '0.0085';
                privateStakedInp.value = '100000';
                sellRatioInp.value = '1';
                bbRatioInp.value = '1';
                daysInp.value = '8';
                // å¯é€‰è§¦å‘è®¡ç®—
                runSimulation();
            });

            // è®¡ç®—ä¸»å‡½æ•°
            function runSimulation() {
                // è¯»å–è¾“å…¥
                let U0 = parseFloat(initUInp.value);
                let H0 = parseFloat(initHInp.value);
                let privateUSDT = parseFloat(privateAmtInp.value);
                let dailyV = parseFloat(dailyVInp.value);
                let dailyRewardH = parseFloat(rewardHInp.value);
                let privateYield = parseFloat(yieldInp.value);
                let privateStaked = parseFloat(privateStakedInp.value); // ç§å‹Ÿè´¨æŠ¼Uæ€»é¢
                let sellRatio = parseFloat(sellRatioInp.value);
                let bbRatio = parseFloat(bbRatioInp.value);
                let days = parseInt(daysInp.value, 10);

                if (isNaN(U0) || U0<=0 || isNaN(H0) || H0<=0 || isNaN(privateUSDT) || privateUSDT<0 ||
                    isNaN(dailyV) || dailyV<0 || isNaN(dailyRewardH) || dailyRewardH<0 || isNaN(privateYield) ||
                    isNaN(privateStaked) || privateStaked<0 || isNaN(sellRatio) || sellRatio<0 || sellRatio>1 ||
                    isNaN(bbRatio) || bbRatio<0 || bbRatio>1 || isNaN(days) || days<1) {
                    alert('è¯·å¡«å†™æœ‰æ•ˆçš„æ­£æ•°ï¼Œæ¯”ä¾‹åœ¨0~1ä¹‹é—´');
                    return;
                }

                // è®¡ç®—æ’å®šä¹˜ç§¯ k
                let k = U0 * H0;  // åˆå§‹k

                // ç¬¬0å¤©ï¼šç§å‹Ÿå
                let U_private = U0 + privateUSDT;
                let H_private = k / U_private;   // æ–°çš„H_LP
                let price0 = U_private / H_private;

                // å‡†å¤‡è¿­ä»£æ•°ç»„
                let daysArr = [];
                // ç¬¬0æ¡è®°å½•
                let record0 = {
                    day: 0,
                    price: price0,
                    U: U_private,
                    H: H_private,
                    treasury: 0,
                    privateRelease: 0,
                };
                daysArr.push(record0);

                let currentU = U_private;
                let currentH = H_private;
                let currentPrice = price0;
                let treasuryAcc = 0;  // å›½åº“ç´¯è®¡(åªæ˜¯ç´¯è®¡æ”¶å…¥, ç”¨äºå±•ç¤º)

                // è¿­ä»£å¤©æ•° 1..days
                for (let d = 1; d <= days; d++) {
                    // 1. å›½åº“æ”¶å…¥ R (åŸºäºå½“æ—¥è®¾å®šçš„äº¤æ˜“é¢)
                    let R = dailyV * TREASURY_RATE;  // USDT
                    treasuryAcc += R;

                    // 2. ç§å‹Ÿé‡Šæ”¾ (ç”¨å‰ä¸€æ—¥ä»·æ ¼)
                    let privateReleaseH = (privateStaked * privateYield) / currentPrice;   // å¾—åˆ°Hæ•°é‡
                    if (isNaN(privateReleaseH) || !isFinite(privateReleaseH)) privateReleaseH = 0;

                    // 3. æ€»å–å‡ºH
                    let totalSellH = (dailyRewardH + privateReleaseH) * sellRatio;

                    // 4. å–å‡ºå¯¹LPçš„å½±å“ (å…ˆå–)
                    // H_temp = H + 0.95 * totalSellH ; U_temp = k / H_temp
                    let H_temp = currentH + NET_RATIO * totalSellH;
                    let U_temp = k / H_temp;   // å–å‡ºåUå‡å°‘

                    // 5. å›è´­ (å›½åº“æ”¯å‡ºR * bbRatio, å®é™…ä¹°å…¥é‡‘é¢æ‰£é™¤ç¨è´¹)
                    let buybackUSDT = R * bbRatio;   // ä»å›½åº“æ”¯å‡ºçš„æ€»é‡‘é¢
                    let actualBuyU = buybackUSDT * NET_RATIO;  // æ‰£é™¤5%ç¨è´¹åå®é™…è¿›å…¥LPçš„U
                    // å›è´­åU_new = U_temp + actualBuyU
                    let U_new = U_temp + actualBuyU;
                    let H_new = k / U_new;

                    // 6. æ›´æ–°ä»·æ ¼
                    let newPrice = U_new / H_new;

                    // ä¿å­˜è®°å½•
                    daysArr.push({
                        day: d,
                        price: newPrice,
                        U: U_new,
                        H: H_new,
                        treasury: treasuryAcc,
                        privateRelease: privateReleaseH,
                    });

                    // æ›´æ–°ä¸‹ä¸€è½®
                    currentU = U_new;
                    currentH = H_new;
                    currentPrice = newPrice;
                }

                // æ¸²æŸ“è¡¨æ ¼
                renderTable(daysArr);
            }

            function renderTable(data) {
                let html = '';
                for (let i = 0; i < data.length; i++) {
                    let r = data[i];
                    // æ ¼å¼åŒ–
                    let priceStr = r.price.toFixed(6);
                    let uStr = r.U.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                    let hStr = r.H.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                    let treasuryStr = r.treasury.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                    let privateStr = r.privateRelease.toFixed(0);
                    html += `<tr>
                        <td><strong>${r.day}</strong></td>
                        <td>$${priceStr}</td>
                        <td>${uStr}</td>
                        <td>${hStr}</td>
                        <td>${treasuryStr} USDT</td>
                        <td>${privateStr} H</td>
                    </tr>`;
                }
                tbody.innerHTML = html;
            }

            // ç»‘å®šè®¡ç®—
            calcBtn.addEventListener('click', runSimulation);

            // é¡µé¢åŠ è½½è‡ªåŠ¨è¿è¡Œä¸€æ¬¡é»˜è®¤å€¼
            window.addEventListener('load', () => {
                runSimulation();
            });
        })();
    </script>
</body>
</html>
